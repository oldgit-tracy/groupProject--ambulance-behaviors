<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CS 360 Midterm Project</title>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Bodo - Simple One Page Personal" name="description">
    <meta content="BdgPixel" name="author">
    <!--Fav-->
    <link href="images/favicon.ico" rel="shortcut icon">

    <!--styles-->
    <link href="bootstrap.min.css" rel="stylesheet">
    <link href="owl.carousel.css" rel="stylesheet">
    <link href="owl.theme.css" rel="stylesheet">
    <link href="magnific-popup.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <link href="responsive.css" rel="stylesheet">

    <!--fonts google-->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,300,500,700' rel='stylesheet' type='text/css'>
    <script src="https://d3js.org/d3.v4.min.js"></script>

    <!--[if lt IE 9]>
       <script type="text/javascript" src="js/html5shiv.min.js"></script>
    <![endif]-->

    <style>
h1 {
    font-size: 300%;
}

h2 {
    font-size: 250%;
}

p {
    font-size: 150%;
}

.content-detail {
  font-size: 150%;
}
</style>
  </head>
  <body id="myPage" data-spy="scroll" data-target=".navbar" data-offset="50">

    <!--HEADER -->
    <div class="header">

      <div class="menu-wrap">
        <nav class="menu">
          <div class="menu-list">
            <a data-scroll="" href="#home" class="active">
              <span>Home</span>
            </a>

            <a data-scroll="" href="#about">
              <span>About</span>
            </a>


            <a data-scroll="" href="#tableauPrototype">
              <span>Tableau Prototype</span>
            </a>

            <a data-scroll="" href="#d3">
              <span>D3</span>
            </a>

            <a data-scroll="" href="#team">
              <span>Team</span>
            </a>



            <a data-scroll="" href="#contact">
              <span>Contact</span>
            </a>
          </div>
        </nav>
        <button class="close-button" id="close-button">Close Menu</button>
      </div>
      <button class="menu-button" id="open-button">
        <span></span>
        <span></span>
        <span></span>
      </button><!--/.for-sticky-->
    </div>
    <!--/.HEADER END-->

    <!--CONTENT WRAP-->
    <div class="content-wrap">
      <!--CONTENT-->
      <div class="content">
        <!--HOME-->
        <section id="home">
          <div class="container">
            <div class="row">
              <div class="wrap-hero-content">
                  <div class="hero-content">
                    <h1>CS 360</h1>
                    <br>
                    <span class="typed"></span>
                  </div>
              </div>

              <div class="mouse-icon margin-20">
                <div class="scroll"></div>
              </div>
            </div>
          </div>
        </section>
        <!--/.HOME END-->

<!-- BEGIN NAVBAR -->
	<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">CS 360: Omega Tron</a>
	<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
	</button>
    </div>
    <ul class="nav navbar-nav" id = "myNavbar">
      <li><a href="#data">Data</a></li>
      <li><a href="#proto">Prototype</a></li>
	     <li><a href="#d3">D3</a></li>
      <li><a href="#team">Team</a></li>
    </ul>
  </div>
</nav>
<!-- END NAVBAR -->

        <!--About-->
        <section class="grey-bg mar-tm-10">
          <div class="container" id="data">
            <div class="row">
              <div class="col-md-12">
                <h1>
                  <span>About</span>
                </h1>
                <p class="content-detail">
                   This project used data collected and published by the City of San Francisco about the time and nature of each call that came in during the December of 2016. Visit <a href = "https://data.sfgov.org/Public-Safety/Fire-Department-Calls-for-Service-December-2016/97i8-upbq?category=Public-Safety&view_name=Fire-Department-Calls-for-Service-December-2016">SF OpenData</a> for our dataset. This dataet has 27,768 observations on 34 different variables. Our visualizations explore 3 dimenions: the Battalion that responded to the event (Battalion), and the times ambulances picked someone up (Transport.DtTm) and arrived at the hospital (Hospital.DtTm).

		<p>
			The line and bar charts are pretty straightforward. The times were reported with accuracy down to the second, but we have binned them by the minute (rounding up at the 31st second) to increase effectiveness.

		<p>
			Note: Not all calls to the SFFD resulted in an ambulance call.
              </div>
            </div>
          </div>
        </section>
        <!--/.About END-->


          <!--TABLEAU PROTOTYPE-->
        <section class="grey-bg mar-tm-10">
          <div class="container" id="proto">
            <div class="row">
              <div class="col-md-12">
                <h1>
                  <span>Tableau Prototype</span>
                </h1>
                <p class="content-detail">
                  
              </div>
              <div class="col-md-9 content-right">
                <!--PORTFOLIO IMAGE-->


                    <a target="_blank" href="https://usf-cs360-2017.github.io/midterm-omega-tron/prototype.html"><img alt="image" src="prototype2.png">
                      </a>
			               <p>
                      These two visualizations emphasize something impossible: some people arrived at the hospital before they were picked up! Or so says the data... The cutaway to the negative times has been stretched vertically, but is true to the x-axis of the area chart.
                      <a target="_blank" href="https://usf-cs360-2017.github.io/midterm-omega-tron/prototype.html"> <em>See original prototype webpage</em> </a>
                <!--/.PORTFOLIO IMAGE END-->
              </div>
            </div>
          </div>
        </section>
        <!--/.TABLEAU PROTOTYPE END-->


        <!--D3-->
        <section class="grey-bg mar-tm-10">
          <div class="container"  id="d3">
            <div class="row">
              <div class="col-md-12">
                <h1>
                  <span>D3</span>
                </h1>
                  <!-- <img src = "vis_1_official.png" height = "500" width = "960"> -->
                  <svg width = "960" height = "500" id = "vis1">
                  <script>

var svg = d3.select("#vis1"),
    margin = {top: 20, right: 20, bottom: 30, left: 20},
    width = svg.attr("width") - margin.left - margin.right,
    height = svg.attr("height") - margin.top - margin.bottom,
    g = svg.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var parseTime = d3.timeParse("%m/%d/%Y %I:%M:%S %p");

var x = d3.scaleLinear().rangeRound([10, width]);

var y = d3.scaleLinear().rangeRound([height, 0]);

var area = d3.area()
    .x(function(d) { return x(d["Minutes"]); })
    .y1(function(d) { return y(d["Count"]); });

d3.csv("lineData.csv", function(d) {
  return d;
}, function(error, data) {
  if (error) throw error;

  x.domain([-40, 80]);

  y.domain([0, d3.max(data, function(d){ return +d["Count"]})]);
  area.y0(y(0));

  g.append("path")
      .datum(data)
      .attr("fill", "red")
    .attr("stroke", "red")
    .attr("stroke-width", 3)
      .attr("d", area);

  //x axis
  g.append("g")
      .attr("transform", "translate(0," + (height+30) + ")")
      .call(d3.axisBottom(x))
      .append("text")
      .attr("fill", "#000")
      .attr("x", 880)
      .attr("y", 25)
      .attr("dx", "0.71em")
      .attr("text-anchor", "end")
      .text("Time (minutes)");

   //y axis
  g.append("g")
      .attr("transform","translate("+10+",0)")
      .call(d3.axisLeft(y))
    .append("text")
      .attr("fill", "#000")
      .attr("transform", "rotate(-90)")
      .attr("y",5)
      .attr("dy", "0.71em")
      .attr("text-anchor", "end")
      .text("Count");
});
    
      //area plot grid lines
  g.append("g")
      .attr("class","gridlines y-gridlines")
      .style("opacity",0.3)
      .attr("transform", "translate(10,0)")
      .call(d3.axisRight(y)
          .ticks(7)
          .tickSize(width)
          .tickSizeOuter(0)
          .tickFormat("")
      );
    

    
    //erase area plot grid lines on callout
    g.append("rect")
      .attr("fill","white")
      .attr("width","242")
      .attr("height","320")
      .attr("x",54)
      .attr("y",32);

      g.append("g")
      .attr("class","gridlines y-gridlines")
      .style("opacity",0.3)
      .attr("transform", "translate(0,0)")
      .call(d3.axisBottom(x)
          .ticks(12)
          .tickSize(height)
          .tickSizeOuter(0)
          .tickFormat("")
      );

  var x_o = 600, y_o = 100;
  
  g.append("text")
    .style("font-size","65px")
    .style("fill","red")
    .attr("transform", "translate(600,100)")
    .text("28%");
  
  g.append("text")
    .style("font-size","25px")
    .style("fill","red")
    .attr("transform", "translate("+(x_o + 125)+","+(y_o - 35)+")")
    .text("of all calls");
 
  g.append("text")
    .style("font-size","25px")
    .style("fill","red")
    .attr("transform", "translate("+(x_o + 125)+","+(y_o - 13)+")")
    .text("to the Fire");
  
  g.append("text")
    .style("font-size","25px")
    .style("fill","red")
    .attr("transform", "translate("+(x_o + 125)+","+(y_o + 8)+")")
    .text("Department");
  
  g.append("text")
    .style("font-size","33px")
    .style("fill","red")
    .attr("transform", "translate("+(x_o + 50)+","+(y_o + 34)+")")
    .text("ended in an");
  
  g.append("text")
    .style("font-size","50px")
    .style("fill","red")
    .attr("transform", "translate("+(x_o + 20)+","+(y_o + 70)+")")
    .text("ambulance");
  
  
  
  var mins = d3.scaleBand().rangeRound([35, 315]).padding(0.1),
    cts = d3.scaleLinear().rangeRound([height, 132]);
  
    var dmn = [-35,-34,-33,-32,-31,-30,-29,-28,-27,-26,-25,-24,-23,-22,-21,-20,-19,-18,-17,-16,-15,-14,-13,-12,-11,-10,-9,-8,-7,-6,-5,-4,-3,-2,-1];
  
  
    d3.csv("barData.csv", function(error, data) {
      if (error) throw error;
        mins.domain(dmn);   
      cts.domain([0,18]);
      
    g.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + (height+30) + ")")
      .call(d3.axisBottom(mins)
            .tickFormat("")
           );
      
    g.append("g")
      .attr("class", "axis axis--y")
      .attr("transform", "translate(53,-100)")
      .call(d3.axisLeft(cts));
  
    // add the Y gridlines
    g.append("g")
      .attr("class","gridlines y-gridlines")
      .style("opacity",0.3)
      .attr("transform", "translate(53,-100)")
      .call(d3.axisRight(cts)
          .ticks(7)
          .tickSize(240)
          .tickSizeOuter(0)
          .tickFormat("")
      );
      
    var bars = g.selectAll("bar").data(data).enter().append("rect")
    .attr("class", "bar")
    .attr("width", mins.bandwidth())
    .attr("fill", "red")
    .attr("x", function(d) {
      return mins(d.Minutes);
    })
    .attr("y", function(d) {
      return cts(d.Count) - cts(19.85);
    })
    .attr("height", function(d) {
      return height - cts(d.Count);
    });
      
    });
                  </script>

                <p class="content-detail">
                   This first chart is an area graph with a callout focusing on a subset of the data. The x-axis is the duration of the ride from the scene to the hospital. This chart includes negative values in the data. Since these values don't make physical sense, they are a sign that something else could be going on. There's no way to tell with the information we have what that could be, or if it is important. It could be that fire fighters simply forget to push some first button until minutes after they've hit the second. Maybe this is just random error- or maybe it's because they're tired. Should we be worried? We can look to the next chart to find out.

                   <br>
                   <br>
                   <br>
                   <br>
                   <!-- <img src = "vis_2_official.png" height = "500" width = "960"> -->
                   <svg width = "960" height = "500" id = "vis2">
                   <script>
                       var svg2 = d3.select("#vis2"),
    margin = {top: 20, right: 80, bottom: 60, left: 60},
    width = svg2.attr("width") - margin.left - margin.right,
    height = svg2.attr("height") - margin.top - margin.bottom,
    g2 = svg2.append("g").attr("transform", "translate(" + margin.left + "," + margin.top + ")");
  
    var battalions = ["B02","B03","B01","B04","B10","B09","B08","B05","B06","B07","B99"];
 
    var bats = d3.scaleBand().domain(battalions).rangeRound([0, width])
    .paddingInner(0.1).paddingOuter(0.05);
    act = d3.scaleLinear().domain([0,9]).rangeRound([height, 0]).nice();
  
    var color = d3.scaleSequential(d3.interpolateBlues).domain([251,5161]);
  
    d3.csv("secondBar.csv", function(error, data) {
      if (error) throw error;
      
    g2.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(bats)
           );
      
    g2.append("g")
      .attr("class", "axis axis--y")
      .call(d3.axisLeft(act));
  
    // add the Y gridlines
    g2.append("g")
      .attr("class","gridlines y-gridlines")
      .style("opacity",0.3)
      .call(d3.axisRight(act)
          .ticks(7)
          .tickSize(width)
          .tickSizeOuter(0)
          .tickFormat("")
      );
      
      //title
    g2.append("text")
      .attr("transform","translate(-25,350) rotate(-90)")
      .text("Negative Times Recorded per 1000 Calls");
      
      //legend
      var l_x = 695, l_y = 450, l_w = 100, l_h = 22;
      g2.append("rect")
        .attr("transform","translate("+ (l_x-1) +","+(l_y-1)+")")
        .attr("width",l_w + 2)
        .attr("height",l_h + 2)
        .attr("fill","black")
      
      g2.append("rect")
        .attr("transform","translate("+l_x+ "," + l_y + ")")
        .attr("width", l_w)
          .attr("height", l_h)
          .style("fill", "url(#gradient)");
      
      g2.append("text")
        .attr("transform","translate(" + (l_x-35) + "," + (l_y+16) + ")")
        .text("251");
      
      g2.append("text")
        .attr("transform","translate(" + (l_x + l_w + 6) + "," + (l_y+16) + ")")
        .text("5161");
      
      var gradient = svg2.append("defs")
        .append("linearGradient")
          .attr("id", "gradient")
          .attr("x1", "100%")
          .attr("y1", "0%")
          .attr("x2", "0%")
          .attr("y2", "0%")
          .attr("spreadMethod", "pad");

      gradient.append("stop")
          .attr("offset", "0%")
          .attr("stop-color", "#2800cc")
          .attr("stop-opacity", 1);

      gradient.append("stop")
          .attr("offset", "100%")
          .attr("stop-color", "#ffffff")
          .attr("stop-opacity", 1);
      
      g2.append("text")
        .style("font-size","12px")
        .attr("transform","translate(" + (l_x + 25) + "," + (l_y - 3) + ")")
        .text("Total Calls");
      
      g2.append("line")
        .attr("stroke","mediumblue")
        .attr("stroke-width","2px")
        .attr("x1",700)
        .attr("x2",635)
        .attr("y1",act(5.65))
        .attr("y2",act(3.53));
      
      var x_off = 670, y_off = 91;
      
      g2.append("text")
        .style("fill","mediumblue")
        .style("font-size","60px")
        .attr("transform","translate("+(x_off + 5)+","+y_off+")")
        .text("0.35%");
      
      g2.append("text")
        .style("fill","mediumblue")
        .style("font-size","40px")
        .attr("transform","translate("+x_off+","+(y_off + 33)+")")
        .text("of all calls");
      
      g2.append("text")
        .style("fill","mediumblue")
        .style("font-size","30px")
        .attr("transform","translate("+(x_off + 15)+","+(y_off + 57)+")")
        .text("had negative");
      
      g2.append("text")
        .style("fill","mediumblue")
        .style("font-size","30px")
        .attr("transform","translate("+(x_off + 50)+","+(y_off + 80)+")")
        .text("times");
      
      g2.append("text")
        .attr("transform","translate(375,460)")
        .text("Battalion");
          
      
    var bars = g2.selectAll("bar").data(data).enter().append("rect")
    .attr("class", "bar")
    .attr("width", bats.bandwidth())
    .attr("stroke","grey")
    .attr("fill", function(d) {
      return color(d.Activity);
    })
    .attr("x", function(d) {
      return bats(d.Battalion);
    })
    .attr("y", function(d) {
      return act(d.Rate);
    })
    .attr("height", function(d) {
      return height - act(d.Rate);
    });
      
      g2.append("line")
        .attr("stroke","red")
        .attr("stroke-width","2px")
        .attr("x1",0)
        .attr("x2",width)
        .attr("y1",act(3.53))
        .attr("y2",act(3.53));
      
    });
                   </script>
                   <!-- <script type="text/javascript" src="bar_per_1000.js"></script> -->
                   <p>
                   This second bar chart does not encode number of records as height. In this chart, the height of the bars proportional to the number of times a battalion reported a negative (impossible) time divided by the total number of calls that Battalion responded to, and the color is proportional to the number of calls that battalion responded to. Our motion for visualizaing this calculation was to get a sense of whether or not some Battalions might be struggling more than others. From our exploratory analysis of the other fields in the data, we did not find and compelling correlates with the entries of negative times. The way this chart shows the tendency of a battalion to make record-keeping mistakes with height, and encodes the total number of calls that battalion responded to with blue allows us to see that Battalion 5 has seemingly the worst performance in this metric, but the color of the bar reminds us to take that value with a grain of salt. The bars are organized from left to right, from most confident to least confident. The average rate of "mistakes" was 0.35%, and is labeled in the graphic.

              </div>
              <div class="col-md-9 content-right">
                <!--PORTFOLIO IMAGE-->
                
                <!-- <script src="bar_per_1000.js"></script> -->
                <!--/.PORTFOLIO IMAGE END-->
              </div>
            </div>
          </div>
        </section>
        <!--/.D3 END-->



        <!--TEAM-->
        <section class="grey-bg mar-tm-10">
          <div class="container" id="team">
            <div class="row">
              <div class="col-md-5">
                <h1>
                  <span>Team</span>
                </h1>

                  <a href="https://usf-cs360-2017.github.io/portfolio-tracyruan007/">Click me to view my personal web<img src="selfie.jpeg" alt="image" ></a>
                  <p style="float:left">My name is Yuanyuan Ruan. I live in San Francisco. I am a senior student in data science major in Univeristy of San Francisco. I am a dream chaser, who enjoy life and challenges.</p>
              </div>

                <div class="col-md-7">
                <div class="col-md-9 content-right">
                  <a href="https://usf-cs360-2017.github.io/portfolio-hdickie/">Click me to view my personal web<img src="hume.jpg" alt="image"></a>
                  <p style="float:left">Hume Dickie -- I am a senior Data Science major at USF. I am a Public Speaking coach on campus and my interests include math, computer science and improv!</p>

                </div>

                </div>
              </div>


          </div>
        </section>
        <!--/.TEAM END-->



        <!--CONTACT-->
        <section id="contact" class="white-bg">
          <div class="container">
            <div class="row">
              <div class="col-md-3">
                <h1>
                  <span>Contact</span>
                </h1>
                <p class="content-detail">
                  Feel free to contact us.

                </p>

              </div>
              <div class="col-md-9 content-right">
                <form>
                  <div class="group">
                    <input required="" type="text"><span class="highlight"></span><span class="bar"></span><label>Name</label>
                  </div>
                  <div class="group">
                    <input required="" type="email"><span class="highlight"></span><span class="bar"></span><label>Email</label>
                  </div>
                  <div class="group">
                    <textarea required=""></textarea><span class="highlight"></span><span class="bar"></span><label>Message</label>
                  </div>
                  <input id="sendMessage" name="sendMessage" type="submit" value="Send Message">
                </form>
              </div>
            </div>
          </div>
        </section>
        <!--/.CONTACT END-->



        </footer>
        <!--/.FOOTER-END-->

      <!--/.CONTENT END-->
      </div>
    <!--/.CONTENT-WRAP END-->
    </div>


    <script src="jquery-1.9.1.min.js"></script>
    <script src="jquery.appear.js"></script>
    <script src="bootstrap.min.js"></script>
    <script src="classie.js"></script>
    <script src="owl.carousel.min.js"></script>
    <script src="jquery.magnific-popup.min.js"></script>
    <script src="masonry.pkgd.min.js"></script>
    <script src="masonry.js"></script>
    <script src="smooth-scroll.min.js"></script>
    <script src="typed.js"></script>
    <script src="main.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Smooth scrolling -->
	<script>
$(document).ready(function(){
  // Add smooth scrolling to all links in navbar + footer link
  $(".navbar a, footer a[href='#myPage']").on('click', function(event) {
  // Make sure this.hash has a value before overriding default behavior
  if (this.hash !== "") {
    // Prevent default anchor click behavior
    event.preventDefault();
    // Store hash
    var hash = this.hash;
    // Using jQuery's animate() method to add smooth page scroll
    // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
    $('html, body').animate({
      scrollTop: $(hash).offset().top
    }, 900, function(){
      // Add hash (#) to URL when done scrolling (default click behavior)
      window.location.hash = hash;
      });
    } // End if
  });
})
</script>
  </body>
</html>
